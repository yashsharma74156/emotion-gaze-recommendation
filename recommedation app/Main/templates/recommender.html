{% extends "layout.html" %}
{% block content %}

<h2 class="mb-4">Browse Books</h2>

<!-- Book Grid -->
<div class="container">
  <div class="row">
    {% for book in initial_books %}
      <div class="col-md-4 mb-4">
        <div class="card h-100 shadow-sm">
          <img class="card-img-top" src="{{ book[1] }}" alt="Book Image">
          <div class="card-body">
            <h5 class="card-title">{{ book[0] }}</h5>
            <p class="card-text"><strong>Year:</strong> {{ book[2] }}</p>
            <p class="card-text"><strong>Author:</strong> {{ book[3] }}</p>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
</div>

<!-- Recommend Button -->
<form method="POST" class="text-center">
  <button type="submit" name="recommend_by_gaze_emotion" class="btn btn-primary mt-4">
    Recommend using Gaze + Emotion
  </button>
</form>

<!-- Display Recommendations -->
{% if realtime %}
  <h4 class="mt-5">Your Personalized Recommendations</h4>
  <div class="row">
    {% for rec in realtime %}
      <div class="col-md-4 mb-4">
        <div class="card h-100 shadow-sm">
          <img class="card-img-top" src="{{ rec[1] }}" alt="Recommended Book Image">
          <div class="card-body">
            <h5 class="card-title">{{ rec[0] }}</h5> <!-- Title -->
            <p class="card-text"><strong>Author:</strong> {{ rec[3] }}</p>
            <p class="card-text"><strong>Year:</strong> {{ rec[2] }}</p>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% endif %}


<!-- Auto Start & Stop Camera -->
<script>
  window.onload = function () {
    fetch('/start-camera');
  };

  window.onbeforeunload = function () {
    fetch('/stop-camera');
  };
</script>

{% endblock %}
